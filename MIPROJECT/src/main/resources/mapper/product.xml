<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.etoile.app.rental.mapper.RentalMapper">
	
	<select id="rentalProductList" resultType="productVO" parameterType="productVO">
		SELECT b.* FROM (SELECT a.*, rownum rnum  FROM (
		SELECT * FROM PRODUCT ) a ) b
		where rnum between #{start} and #{end}
	</select>
	
	<select id="productCnt" resultType="int">
		SELECT count(*) from product
		<where>
			<if test="productName != null">
				product_name like '%' || #{productName} || '%'
			</if>
		</where>
	</select>
	<select id="rentalList" resultType="RentalVO">
		select * from rental r, product p
		where p.product_id = r.product_id
	</select>
	
	<select id="rentalProductSelect" resultType="productVO">
		SELECT * FROM PRODUCT WHERE product_id = #{productId}
	</select>
	
	<select id="searchList" resultType="productVO">
		SELECT b.* FROM (SELECT a.*, rownum rnum  FROM (
		SELECT * FROM PRODUCT WHERE product_name like '%' || #{productName} || '%' ) a ) b
		where rnum between #{start} and #{end}
	</select>
	
	<select id="pickList" resultType="pickVO">
		SELECT * from product pr, pick pi
		where pr.product_id = pi.product_id
	</select>
		
	<insert id="RentalInsert">
		insert into rental(rental_id, product_id, rental_start, rental_end, rental_address, rental_pay)
		values (r_seq.nextval, #{productId}, #{rentalStart}, #{rentalEnd}, #{rentalAddress}, #{rentalPay})
	</insert>
	
	<select id="selectPick" resultType="int">
		select count(*) from pick where product_id like #{productId}
	</select>
	
	<insert id="productPickInsert">
		insert into pick (pick_id, product_id) values (pi_seq.nextval, #{productId})
	</insert>
	
	<delete id="pickDelete">
		delete from pick where product_id like #{productId}
	</delete>

</mapper>